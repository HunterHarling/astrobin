{% load avatar_tags %}
{% load common_tags %}
{% load i18n %}
{% load hitcount_tags %}
{% load tags %} {% comment %} TODO: rename tags to astrobin_tags {% endcomment %}
{% load toggleproperty_tags %}

<div class="subtle-container avatar-block">
    <div class="avatar">
        <a href="{% url user_page image.user %}">
            {% avatar image.user 106 %}
        </a>
    </div>
    <div class="username">
        <a
            class="username-link"
            rel="tooltip"
            title="{{image.user.userprofile}}"
            href="{% url user_page image.user %}">{{image.user.userprofile|truncatechars:20}}</a>

        <div class="data">
            <img class="license"
                 src="{{STATIC_URL}}icons/{{license_icon}}"
                 alt="{% trans "License" %}: {{license_title}}"
                 title="{% trans "License" %}: {{license_title}}" />

            <span class="uploaded">{{uploaded_on|ago}}</span>

            <div>
                <span class="views">
                    {% get_hit_count for image as hit_count %}
                    {% trans "Views" %}: <span class="number">{{hit_count}}</span>
                </span>,

                <span class="bookmarks">
                    {% trans "Bookmarks" %}:
                    <span class="number">{{image.bookmarks}}</span>
                </span>,

                <span class="bookmarks">
                    {% trans "Likes" %}:
                    <span class="number">{{image.likes}}</span>
                </span>
            </div>
        </div>

        {% if user.is_authenticated %}
            <a class="btn btn-primary{% if follows %} unfollow{% else %} follow{% endif %}"
               href="{% if follows %}{% url unfollow image.user %}{% else %}{% url follow image.user %}{% endif %}{% query_string "next=request.path" "plate_solving_started" %}"
               rel="tooltip"
               title="{% if follows %}{% trans "Stop following" %}{% else %}{% trans "Follow" %}{% endif %}">
                {% if follows %}
                    <i class="icon-eye-close"></i>
                {% else %}
                    <i class="icon-eye-open"></i>
                {% endif %}
            </a>

            {% add_remove_toggleproperty "bookmark" image request.user %}
        {% endif %} <!-- authenticated -->
    </div>
</div>



{% extends 'base.html' %}
{% load i18n %}
{% load tags %}

{% block content %}
    {% include 'profile-edit-menu.html' %}
    <div class="sided-main-content">
        <h1>{% trans "Edit your astrophotography gear" %}</h1>
        <table class="form_saved_container">
            <tr>
                <td>{% form_saved request %}</td>
                {% if request.GET.initial == 'true' %}
                <td><a href="/">{% trans "Go back to the home page." %}</a></td>
                {% endif %}
            </tr>
        </table>
        <p id="form_help_text" style="display:none">{% blocktrans %}Remember that these items autocomplete, and you need to press TAB to add something to your list. If it's not in a white box, it doesn't get saved!{% endblocktrans %}</p>
        <p><strong>{% blocktrans %}Please use full names (make and model) for all your gear items!{% endblocktrans %}</strong></p>
        <form method="post" action="{% url profile_save_gear %}">{% csrf_token %}
            {{form.as_p}}
            {% if initial %}
            <input type="hidden" name="initial"/>
            {% endif %}
            <noscript>
                <p class="hint">
                {% blocktrans %}* use a comma to separate the values.{% endblocktrans %}
                </p>
            </noscript>
            <p><input class="button submit-button" type="submit" value="{% trans "Save" %}" /></p>
        </form>
    </div>  
{% endblock %}

{% block extra_js %}
    <script language="javascript">
    $(document).ready(function() {
        $('p#form_help_text').show();

        var startText = "{% trans "Enter partial name and wait for the suggestions!" %}";
        var emptyText = "{% trans "No results. Press TAB to add it!" %}";
        var resultsTitleText = "{% trans "Click on a suggestion or press TAB to add what you typed" %}";
        {% autoescape off %}
        {% for key, value in prefill_dict.items %}
        $('#id_{{key}}').autoSuggest('/autocomplete/{{key}}/',
            {asHtmlID: '{{key}}',
            selectedItemProp: 'name',
            searchObjProps: 'name',
            preFill: {{value}},
            selectedItemProp: 'name',
            selectedValuesProp: 'name',
            startText: startText,
            emptyText: emptyText,
            resultsTitleText: resultsTitleText});
        {% endfor %}
        {% endautoescape %}
    });
    </script>
{% endblock %}


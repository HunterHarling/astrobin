{% extends 'base.html' %}

{% load i18n %}
{% load tags %}

{% block content %}

<a name="page_anchor"></a>
<div class="full-box advanced-search-box">
    <form method="get" action="{% url haystack_search %}">
        {{form.as_p}}
        <input class="button submit-button" type="submit" value="{% trans "Search" %} &rarr;" />
    </form>
</div>

<div id="search-results" class="full-box clear search">
    {% if 'q' in request.GET %}
    <div class="search-links">
            {% trans "Sort these images by:" %}&nbsp;
            <a href="/search/{% query_string "" "sort" %}">{% trans "Relevance" %}</a>&nbsp;|&nbsp;
            <a href="/search/{% query_string "sort='-uploaded'" "" %}">{% trans "Upload time" %}</a>&nbsp;|&nbsp;
            <a href="/search/{% query_string "sort='-rating'" "" %}">{% trans "Rating" %}</a>&nbsp;|&nbsp;
            <a href="/search/{% query_string "sort='-integration'" "" %}">{% trans "Integration" %}</a>&nbsp;|&nbsp;
            <a href="/search/{% query_string "sort='-views'" "" %}">{% trans "Views" %}</a>
    </div>
    {% search_image_list request page.object_list %}
    {% else %}
    <p class="noterms">{% blocktrans %}Please input some search terms!{% endblocktrans %}</p>
    {% endif %}
</div>
{% endblock %}

{% block extra_js %}
<script language="javascript">
    $(document).ready(function() {
        {% autoescape off %}
        {% for key, value in prefill_dict.items %}
        var startText = '{{value.1}}';
        var emptyText = '{{value.2}}';
        var resultsTitleText = '{{value.3}}';
        $('#id_{{key}}').autoSuggest('/autocomplete/{{key}}/',
            {asHtmlID: '{{key}}',
            selectedItemProp: 'name',
            searchObjProps: 'name',
            preFill: {{value.0}},
            selectedItemProp: 'name',
            selectedValuesProp: 'id',
            startText: startText,
            emptyText: emptyText,
            resultsTitleText: resultsTitleText});
        {% endfor %}
        {% endautoescape %}
    });
</script>
{% endblock %}

{% extends 'base.html' %}
{% load i18n %}
{% load tags %}

{% block title %}AstroBin - {% blocktrans with user=user %}{{user}}'s gallery{% endblocktrans %}{% endblock %}
{% block content %}
<a name="page_anchor"></a>
{% include 'user/profile-subnav.html' %}

<h1>
    {% ifequal user request.user %}
        {% blocktrans %}View your images{% endblocktrans %}
    {% else %}
        {% blocktrans with user.username as username %}View {{username}}'s images:{% endblocktrans %}
    {% endifequal %}
</h1>

{% if user == request.user and section == 'staging' %}
<div class="well">
    {% blocktrans %}These are your "work in progress" images: only you can see this list. You can show people individual images by sharing them using the <em>Share</em> menu.{% endblocktrans %}
</div>
{% endif %}

<div class="album">
    {% if section == 'public' and not image_list %}
        {% if subsection == 'nodata' %}
        <div class="well">
            {% blocktrans %}These images don't have enough data. It's a shame...{% endblocktrans %}
            {% if request.user = user %}
                {% blocktrans %}If you want your images to be categorized in albums, you should really fill in some data. Imaging telescopes, imaging cameras and subjects are the bare minimum. Dates of acquisitions are very important too.{% endblocktrans %}
            {% endif %}
        </div>
        {% endif %}

        {% for album in smart_albums %}
            {% for item in album %}
                {% for title, content in item.items %}
                    {% if content.images %}
                    <div class="album-part">
                        <div class="well">
                            <strong>{{title}}</strong>
                            {% ifequal content.images|length 15 %}
                                <span class="more"><a href="?public&sub={{subsection}}&{{subsection}}={{title}}">{% trans "(view more...)" %}</a></span>
                            {% endifequal %}
                        </div>
                        {% if user == request.user and content.message %}
                        <p>
                            {{content.message|safe}}
                        </p>
                        {% endif %}
                        {% image_list request content.images 0 %} {% comment %}0 is for False (no pagination){% endcomment %}
                    </div>
                    {% endif %}
                {% endfor %}
            {% endfor %}
        {% empty %}
            {% blocktrans %}No images.{% endblocktrans %}
        {% endfor %}
    {% else %}
        {% if subtitle %}
            <div class="well">
                <strong>{{subtitle}}</strong> 
                {% if backlink %}
                    <span class="back"><a href="{{backlink}}">{% trans "(go back)" %}</a></span>
                {% endif %}
            </div>
        {% endif %}
        {% if subsection == 'acquired' %}
        <div class="well">
            {% blocktrans %}These images are ordered so that the most recently acquired appear first. Please note: images with no acquisition dates will appear last, and in no particular order.{% endblocktrans %}
            {% if request.user == user %}
                <strong>{% blocktrans %}Please fill in the missing dates on all your images!{% endblocktrans %}</strong>
            {% endif %}
        </div>
        {% endif %}
        {% image_list request image_list %}
    {% endif %}
</div>

{% if request.user == user %}
<noscript>
<div class="tools-box clear">
    <h2>{% trans "Tools" %}</h2>
    <ul>
        <li>
            <a href="{% url profile_edit_basic %}">
                <img src="/static/icons/iconic/orange/edit_profile.png" alt="{% trans "Edit profile" %}"/>
            </a>
            <a href="{% url profile_edit_basic %}">
                {% trans "Edit profile" %}
            </a>
        </li>
        <li>
            <a href="{% url auth_logout %}">
                <img src="/static/icons/iconic/orange/logout.png" alt="{% trans "Logout" %}"/>
            </a>
            <a href="{% url auth_logout %}">
                {% trans "Logout" %}
            </a>
        </li>
    </ul>
</div>
</noscript>
{% endif %}
</div> <!-- profile -->
{% endblock %}

{% block extra_js %}
    {% include 'user/profile-js.html' %}
{% endblock %}

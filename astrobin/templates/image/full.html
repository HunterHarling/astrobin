{% load tags %}
{% load i18n %}
{% load compressed %}

{% load hitcount_tags %}

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <title>{% block title %}AstroBin{% endblock %}</title>

        <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
        <meta name="author" content="Salvatore Iovene - http://iovene.com/" />
        <meta name="description" content="Community for astrophotographers" />
        <meta name="keywords" content="astrophotography, astronomy, telescopes" />
        <meta name="robots" content="index, follow, noarchive" />
        <meta name="googlebot" content="noarchive" />

        <!-- font -->
        <link href='http://fonts.googleapis.com/css?family=Droid+Sans:400,700' rel='stylesheet' type='text/css'/>
        {% compressed_css 'screen' %}

        <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-844985-10']);
          _gaq.push(['_trackPageview']);
          {% if user.is_authenticated %}
          _gaq.push(['_setCustomVar', 1, 'User Type', 'Member']);
          _gaq.push(['_setCustomVar', 2, 'Username', '{{user.username}}']);
          {% else %}
          _gaq.push(['_setCustomVar', 1, 'User Type', 'Anonymous']);
          {% endif %}

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        </script>
    </head>

    <body class="full">
        <div class="navbar navbar-fixed-top" id="top">
            <div class="navbar-inner">
                <div class="container">
                    <ul class="nav">
                        <a class="brand" href="{% url index %}">
                            <img src="{{STATIC_URL}}images/astrobin-logo-square-mini.png" alt="AstroBin" />
                        </a>
                        <li>
                            <div class="full-title">
                                <span class="title">{{image.title|escape|default:_("(no title)")}}</span>
                                <span class="subtitle">
                                    ({% trans "uploaded" %}: {{image.uploaded|ago}}
                                    {% url user_page image.user.username as the_url %}
                                    {% blocktrans with user=image.user.username %}by <a href="{{the_url}}">{{user}}</a>{% endblocktrans %})
                                </span>
                            </div>
                        </li>
                    </ul>
                    <ul class="nav pull-right">
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                {% trans "View" %}
                                <span class="caret"></span>
                            </a>
                            {% with request.GET.mod as mod %}
                                <ul class="dropdown-menu">
                                    <li>
                                        <a href="{% url image_detail image.id %}{% query_string "mod=mod" "" %}">
                                            {% blocktrans %}Technical card{% endblocktrans %}
                                        </a>
                                    </li>
                                    <li>
                                        {% if real %}
                                            <a href="{% url image_full image.id %}{% query_string "mod=mod" "real" %}">
                                                {% blocktrans %}Fit to window{% endblocktrans %}
                                            </a>
                                        {% else %}
                                            <a href="{% url image_full image.id %}{% query_string "mod=mod,real=''" "" %}">
                                                {% blocktrans %}Full resolution{% endblocktrans %}
                                            </a>
                                        {% endif %}
                                    </li>
                                </ul>
                            {% endwith %}
                        </li>
                    </ul>
                </div>
            </div>
        </div>
  
        <div id="full-size-image">
            {% if revision_image %}
                 {% with revision_image as image %}
                 {% with request.GET.mod as mod %}
                 <a href="{% url image_detail image.image.id %}{% query_string "mod=mod" "" %}">
                      <img {% if real %}class="real"{% endif %} src="http://astrobin_images.{{s3_url}}/{{image.filename}}{% ifequal request.GET.mod 'inverted' %}_inverted{% endifequal %}{{image.original_ext}}"
                           alt="{{image.title|escape}}">
                 </a>
                 {% endwith %}
                 {% endwith %}
            {% else %}
            {% with request.GET.mod as mod %}
            <a href="{% url image_detail image.id %}{% query_string "mod=mod" "" %}">
                <img {% if real %}class="real"{% endif %} src="http://astrobin_images.{{s3_url}}/{{image.filename}}{% ifequal request.GET.mod 'inverted' %}_inverted{% endifequal %}{{image.original_ext}}"
                     alt="{{image.title|escape}}">
            </a>
            {% endwith %}
            {% endif %}
        </div>
        <script type="text/javascript" src="{{STATIC_URL}}js/jquery-1.7.1.js"></script>
        <script type="text/javascript" src="{{STATIC_URL}}js/bootstrap.min.js"></script>
        <script type="text/javascript" src="{{STATIC_URL}}js/astrobin.js"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                astrobin_common.init_ajax_csrf_token();
                {% get_hit_count_javascript for image %}

                {% if image.w > 0 %}
                if ($(window).width() * .95 > {{image.w}}) {
                    $('#full-size-image img').addClass('real');
                }
                {% endif %}
            });
        </script>
    </body>
</html>


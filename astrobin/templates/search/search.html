{% extends 'base.html' %}

{% load i18n %}
{% load tags %}

{% block content %}
<div class="full-box">
    <p><a href="#" onclick="common.showHideAdvancedSearch()">{% trans "Show/hide advanced search box." %}</a></p>
    <form id="advanced_search" method="get" action="{% url haystack_search %}">{% csrf_token %}
        {{form.as_p}}
        <input class="button submit-button" type="submit" value="{% trans "Search" %} &rarr;" />
    </form>
</div>

<a name="pag_anchor"></a>
<div id="search-results" class="full-box clear">
    <h2>
        {% if query %}
            {% trans "Images matching" %} <em>"{{query}}"</em>
        {% else %}
            {% trans "All images" %}
        {% endif %}

        {% if 'start_date' in request.GET and 'end_date' in request.GET and request.GET.start_date != '' and request.GET.end_date != '' and request.GET.start_date == request.GET.end_date %}
            &nbsp;{% trans "acquired on" %} {{request.GET.start_date|string_to_date|date:"DATE_FORMAT"}}
        {% else %}
            {% if 'start_date' in request.GET and request.GET.start_date != '' %}
                &nbsp;{% trans "acquired after" %} {{request.GET.start_date|string_to_date|date:"DATE_FORMAT"}}
                {% if 'end_date' in request.GET and request.GET.end_date != '' %}
                    &nbsp;{% trans "and before" %} {{request.GET.end_date|string_to_date|date:"DATE_FORMAT"}}
                {% endif %}
            {% else %}
                {% if 'end_date' in request.GET and request.GET.end_date != '' %}
                    &nbsp;{% trans "acquired before" %} {{request.GET.end_date|string_to_date|date:"DATE_FORMAT"}}
                {% endif %}
            {% endif %}
        {% endif %}
    </h2>

    <div class="sort">
            {% trans "Sort these images by:" %}&nbsp;
            <a href="/search/?q={{query}}">{% trans "Relevance" %}</a>&nbsp;|&nbsp;
            <a href="/search/?q={{query}}&sort=-uploaded">{% trans "Upload time" %}</a>&nbsp;|&nbsp;
            <a href="/search/?q={{query}}&sort=-rating">{% trans "Rating" %}</a>&nbsp;|&nbsp;
            <a href="/search/?q={{query}}&sort=-integration">{% trans "Integration" %}</a>
    </div>

    {% load tags %}
    {% image_list request page.object_list %}
    <div class="pagination">
        <span class="step-links">
            {% if page.has_previous %}
                <a href="?page={{page.previous_page_number}}{% if query %}&amp;q={{query}}{% endif %}#pag_anchor">&laquo; {% trans "previous" %}</a>
            {% endif %}
            {% if page.has_previous and page.has_next %}|{% endif %}
            {% if page.has_next %}
                <a href="?page={{page.next_page_number}}{% if query %}&amp;q={{query}}{% endif %}#pag_anchor">{% trans "next" %} &raquo;</a>
            {% endif %}
        </span>
    </div>
</div>
{% endblock %}

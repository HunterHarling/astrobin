{% extends 'base.html' %}
{% load i18n %}
{% load tags %}

{% block content %}
    {% include 'profile-edit-menu.html' %}
    <div class="sided-main-content">
        <h1>{% trans "Edit your basic information" %}</h1>
        {% form_saved request %}
        <form method="post" action="{% url profile_save_basic %}">{% csrf_token %}
            {{form.as_p}}
            <ul>
                <li><input class="button submit-button" type="submit" value="{% trans "Save" %}" /></li>
                {% comment %}We should use {% url password_change %} or something.{% endcomment %}
                <li><a href="/accounts/password/change/">{% trans "or click here to change your password" %}</a>
            </ul>
        </form>
    </div>  
{% endblock %}

{% block extra_js %}
    <script language="javascript">
        $(document).ready(function() {
            var selects = $("select#id_timezone");
            if (selects.length > 0 && selects.val() == "") {  
             var offset_minutes = new Date().getTimezoneOffset();
             var offset = 100 * offset_minutes / 60;
             var default_value = _first_timezone_match(selects, offset);  
             selects.val(default_value);
            }

            function _first_timezone_match(selects, offset) {
             var match = "";
             selects.find("option").each(function() {
              // ex: "(GMT-0500) America/New_York"
              if ($(this).text().indexOf(offset) > 0) {
               match = $(this).val();
              }
             });
             return match;
            }
        });
    </script>
{% endblock %}


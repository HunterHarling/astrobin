{% load common_tags %}
{% load i18n %}

<li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
        <i class="icon-bolt icon-white"></i>
        {% trans "Actions" %}
        <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
        {% if request.user == image.user or request.user.is_superuser %}
        <li>
            <a href="{% url image_edit_basic image.id %}">
                <i class="icon-edit"></i>
                {% trans "Edit basic information" %}
            </a>
        </li>
        {% if image.subject_type < 500 %}
            <li>
                <a href="{% url image_edit_gear image.id %}">
                    <i class="icon-cog"></i>
                    {% trans "Edit gear used" %}
                </a>
            </li>
            <li>
                <a href="{% url image_edit_acquisition image.id %}">
                    <i class="icon-time"></i>
                    {% trans "Edit acquisition details" %}
                </a>
            </li>
        {% endif %}
        {% if not is_final %}
        <li>
            {% if is_revision %}
            <a href="{% url image_edit_revision_make_final revision_image.id %}">
            {% else %}
            <a href="{% url image_edit_make_final image.id %}">
            {% endif %}
                <i class="icon-ok"></i>
                {% trans "Mark this revision as final" %}
            </a>
        </li>
        {% endif %} <!-- not is_final -->
        <li class="divider"></li>
        <li>
            <a href="{% url image_edit_license image.id %}">
                <i class="icon-legal"></i>
                {% trans "Change license" %}
            </a>
        </li>
        <li>
            <a class="upload-revision" href="#">
                <i class="icon-upload-alt"></i>
                {% trans "Upload new revision" %}
            </a>
        </li>
        {% if image.subject_type == 100 or image.subject_type == 300 %}
            {% if not image.is_solved and not is_revision %}
            <li>
                <a class="plate-solve" href="{% url image_edit_presolve image.id %}{% query_string "done_later=" "plate_solving_started" %}">
                    <i class="icon-screenshot"></i>
                    {% trans "Plate-solve" %}
                </a>
            </li>
            {% else %}
            <li>
                <a class="plate-solve" href="{% url image_edit_presolve image.id %}{% query_string "done_later=" "plate_solving_started" %}">
                    <i class="icon-screenshot"></i>
                    {% trans "Plate-solve again" %}
                </a>
            </li>
            {% endif %} <!-- not image.is_solved and not is_revision -->
        {% endif %} <!-- image is deep sky or wide field -->
        {% if image.is_wip %}
        <li>
            <a href="{% url image_promote image.id %}{% query_string "" "plate_solving_started" %}">
                <i class="icon-unlock"></i>
                {% trans "Promote to public area" %}
            </a>
        </li>
        {% else %}
        <li>
            <a href="{% url image_demote image.id %}{% query_string "" "plate_solving_started" %}">
                <i class="icon-lock"></i>
                {% trans "Move to staging area" %}
            </a>
        </li>
        {% endif %} <!-- image.is_wip -->

        <li class="divider"></li>
        <li>
            <a data-toggle="modal" href="#send-to-datapool-modal">
                <i class="icon-plus-sign"></i>
                {% trans "Send to public data pool" %}
            </a>
        </li>

        <li>
            <a data-toggle="modal" href="#send-to-sharedfolder-modal">
                <i class="icon-plus-sign"></i>
                {% trans "Send to private shared folder" %}
            </a>
        </li>

        <li class="divider"></li>
        <li>
        {% if not is_revision %}
            {% if revisions %}
            <a class="delete-original danger" href="{% url image_delete_original image.id %}">
                <i class="icon-remove"></i>
                {% trans "Delete original image" %}
            </a>
            {% else %}
            <a class="delete-everything danger" href="{% url image_delete image.id %}">
                <i class="icon-remove"></i>
                {% trans "Delete everything" %}
            </a>
            {% endif %} <!-- revisions -->
        {% else %}
            <a class="delete-revision danger" href="{% url image_delete_revision image.id %}">
                <i class="icon-remove"></i>
                {% trans "Delete this revision" %}
            </a>
        {% endif %} <!-- not is_revision -->
        </li>
        {% endif %} <!-- owner or superuser -->
        <li class="divider"></li>
        <li>
            <a href="{% url bring_to_attention image.id %}">
                <i class="icon-retweet"></i>
                {% trans "Bring to a user's attention" %}
            </a>
        </li>
        {% if image.subject_type == 100 or image.subject_type == 300 %}
        <li class="divider"></li>
        <li>
            <a class="messier-nomination" href="{% url messier_nomination image.id %}">
                <i class="icon-book"></i>
                {% trans "Nominate for the Messier Marathon" %}
            </a>
        </li>
        {% endif %}
     </ul>
 </li> <!-- actions -->


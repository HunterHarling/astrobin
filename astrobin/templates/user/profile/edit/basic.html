{% extends 'base.html' %}
{% load i18n %}
{% load tags %}

{% block content %}
    {% include 'profile-edit-menu.html' %}
    <div class="sided-main-content">
        <h1>{% trans "Edit your basic information" %}</h1>
        {% form_saved request %}
        <p id="form_help_text" style="display:none">{% blocktrans %}Remember that the location field autocompletes, and you need to press TAB to add something to your list. If it's not in a white box, it doesn't get saved!{% endblocktrans %}
        <form method="post" action="{% url profile_save_basic %}">{% csrf_token %}
        {{form.as_p}}
        <span class="helptext">{% blocktrans %}These are the cities from which you usually image.{% endblocktrans %}</span>
        <noscript>
            <p class="hint">
            {% blocktrans %}* use a comma to separate the values.{% endblocktrans %}
            </p>
        </noscript>
        <ul>
            <li><input class="button submit-button" type="submit" value="{% trans "Save" %}" /></li>
            {% comment %}We should use {% url password_cchange %} or something.{% endcomment %}
            <li><a href="/accounts/password/change/">{% trans "or click here to change your password" %}</a>
        </ul>
        </form>
    </div>  
{% endblock %}

{% block extra_js %}
    <script language="javascript">
        $(document).ready(function() {
            $('p#form_help_text').show();

            var startText = '{% trans "Enter partial name and wait for the suggestions!" %}';
            var emptyText = '{% trans "No results. Press TAB to add it!" %}';
            var resultsTitleText = '{% trans "Matching items (press TAB to add what you typed instead):" %}';
            {% autoescape off %}
            {% for key, value in prefill_dict.items %}
            $('#id_{{key}}').autoSuggest('/autocomplete/{{key}}/',
                {asHtmlID: '{{key}}',
                selectedItemProp: 'name',
                searchObjProps: 'name',
                preFill: {{value}},
                selectedItemProp: 'name',
                selectedValuesProp: 'name',
                startText: startText,
                emptyText: emptyText,
                resultsTitleText: resultsTitleText});
            {% endfor %}
            {% endautoescape %}
        });
    </script>
{% endblock %}

